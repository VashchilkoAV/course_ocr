/home/avashchilko/abbyy10sem/course_ocr/task2/task2pack/models/loss.py:30: UserWarning: This overload of addmm_ is deprecated:
	addmm_(Number beta, Number alpha, Tensor mat1, Tensor mat2)
Consider using one of the following signatures instead:
	addmm_(Tensor mat1, Tensor mat2, *, Number beta, Number alpha) (Triggered internally at ../torch/csrc/utils/python_arg_parser.cpp:1420.)
  distmat.addmm_(1, -2, x, self.centers.t())
Initial val: [regular_loss: 0.004350646929373119, trainable_loss: 0.12735391599905124, accuracy: 0.00017219740959248164]
Epoch 1:
Train loss: [regular: 0.007178247778802263 trainable: 0.24890000100364904]
Epoch 2:
Train loss: [regular: 0.000882306655005405 trainable: 0.06065630299034615]
Val : [regular_loss: 0.00022231336407306005, trainable_loss: 0.008682459246301547, accuracy: 0.8912146743219533]
Epoch 3:
Train loss: [regular: 0.0006687187813268309 trainable: 0.02274927369016263]
Epoch 4:
Train loss: [regular: 0.0005840435117319716 trainable: 0.010844920255361728]
Val : [regular_loss: 0.00016791660935666574, trainable_loss: 0.001979475251167088, accuracy: 0.9144923511772253]
Epoch 5:
Train loss: [regular: 0.0005273584490958508 trainable: 0.005955936120137415]
Epoch 6:
Train loss: [regular: 0.0004826901764370506 trainable: 0.0036343484862618055]
Val : [regular_loss: 0.00015714547571872708, trainable_loss: 0.0007567535075909171, accuracy: 0.919605528312512]
Epoch 7:
Train loss: [regular: 0.0004434262492947882 trainable: 0.0024268701533131927]
Epoch 8:
Train loss: [regular: 0.0004074949847229627 trainable: 0.001749671646495106]
Val : [regular_loss: 0.0001434846046527346, trainable_loss: 0.000401752213074253, accuracy: 0.9254261110223406]
Epoch 9:
Train loss: [regular: 0.000376242887963947 trainable: 0.0013436738312304218]
Epoch 10:
Train loss: [regular: 0.0003472971470466458 trainable: 0.001080339578400543]
Val : [regular_loss: 0.00013335873989249418, trainable_loss: 0.0002612325694487405, accuracy: 0.9305656607338713]
Epoch 11:
Train loss: [regular: 0.0003218604736169105 trainable: 0.0008979451869324179]
Epoch 12:
Train loss: [regular: 0.00029870069891848266 trainable: 0.0007648511052163415]
Val : [regular_loss: 0.00012891836843320625, trainable_loss: 0.00019270730628634763, accuracy: 0.9327964704185018]
Epoch 13:
Train loss: [regular: 0.000278082227559661 trainable: 0.0006632528170494665]
Epoch 14:
Train loss: [regular: 0.00025927764896235264 trainable: 0.0005825279556614233]
Val : [regular_loss: 0.00012461982302539224, trainable_loss: 0.0001488550245580545, accuracy: 0.9342748860161741]
Epoch 15:
Train loss: [regular: 0.00024180864497925302 trainable: 0.0005165510430807672]
Epoch 16:
Train loss: [regular: 0.00022573391651971525 trainable: 0.0004623172797524704]
Val : [regular_loss: 0.0001205505856022824, trainable_loss: 0.00012033276219317968, accuracy: 0.9364994903887472]
Epoch 17:
Train loss: [regular: 0.0002113051899867361 trainable: 0.0004166460994714733]
Epoch 18:
Train loss: [regular: 0.00019781632593903026 trainable: 0.00037791478446025747]
Val : [regular_loss: 0.00011632085411835877, trainable_loss: 9.858284867888797e-05, accuracy: 0.938834239050339]
Epoch 19:
Train loss: [regular: 0.00018531911738235552 trainable: 0.00034429087195803775]
Epoch 20:
Train loss: [regular: 0.00017402458445728956 trainable: 0.00031541370142734764]
Val : [regular_loss: 0.00011701653898171463, trainable_loss: 8.362075065436861e-05, accuracy: 0.9379717006743623]
Epoch 21:
Train loss: [regular: 0.0001402657238975942 trainable: 0.0002758186712766046]
Epoch 22:
Train loss: [regular: 0.0001309996518705888 trainable: 0.00025475267510507066]
Val : [regular_loss: 0.00011231161113194478, trainable_loss: 6.907572143159506e-05, accuracy: 0.9408633760931046]
Epoch 23:
Train loss: [regular: 0.00012353826258564864 trainable: 0.0002373118084123212]
Epoch 24:
Train loss: [regular: 0.00011655999047621523 trainable: 0.00022200490628967537]
Val : [regular_loss: 0.00011134761287762786, trainable_loss: 6.114684397946792e-05, accuracy: 0.9414234055062837]
Epoch 25:
Train loss: [regular: 0.00011020488661362994 trainable: 0.00020840570532190922]
Epoch 26:
Train loss: [regular: 0.00010446301319008611 trainable: 0.0001961540629311166]
Val : [regular_loss: 0.00011243471191428839, trainable_loss: 5.428233275680238e-05, accuracy: 0.9409347371817645]
Epoch 27:
Train loss: [regular: 9.912623550698425e-05 trainable: 0.00018500613825569396]
Epoch 28:
Train loss: [regular: 9.388674913976575e-05 trainable: 0.00017504021302452134]
Val : [regular_loss: 0.00011258881668865561, trainable_loss: 4.833054422399969e-05, accuracy: 0.941617321508077]
Epoch 29:
Train loss: [regular: 8.93156221313701e-05 trainable: 0.0001660032298506645]
Epoch 30:
Train loss: [regular: 8.496882908404186e-05 trainable: 0.00015755248893729523]
Val : [regular_loss: 0.00011379196964672803, trainable_loss: 4.452627723259386e-05, accuracy: 0.9404957113537044]































100%|█████████████████████████████████████████████████████████████████████████████████| 380/380 [01:01<00:00,  6.22it/s]